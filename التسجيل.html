<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HOBA TECH | Ø§Ù„ØªØ³Ø¬ÙŠÙ„</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap');
html { scroll-behavior: smooth; }
:root {
  --glow-color: #0044cc;
  --bg-dark: #050505;
  --glass: rgba(255, 255, 255, 0.05);
}
body {
  margin: 0; padding: 0;
  font-family: 'Cairo', sans-serif;
  background: var(--bg-dark);
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  color: white;
}
.bg-glow {
  position: absolute; width: 300px; height: 300px;
  background: var(--glow-color); filter: blur(150px);
  border-radius: 50%; z-index: -1; opacity: 0.3;
  animation: move 10s infinite alternate;
}
@keyframes move { from { transform: translate(-50%, -50%); } to { transform: translate(50%, 50%); } }
.auth-card {
  background: var(--glass); padding: 30px;
  border-radius: 25px; border: 1px solid rgba(0,68,204,0.3);
  width: 350px; text-align: center; backdrop-filter: blur(20px);
  box-shadow: 0 20px 50px rgba(0,0,0,0.5);
}
.auth-card h2 { color: var(--glow-color); font-size: 28px; margin-bottom: 10px; letter-spacing: 2px; }
.auth-card p { font-size: 14px; color: #bbb; margin-bottom: 20px; }
input, select {
  width: 100%; padding: 12px 15px; background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; color: white;
  outline: none; box-sizing: border-box; transition: 0.3s; font-family: 'Cairo';
}
input:focus, select:focus { border-color: var(--glow-color); background: rgba(0,68,204,0.1); }
.btn-auth {
  width: 100%; padding: 12px; background: var(--glow-color);
  border: none; color: white; border-radius: 12px; font-weight: bold; font-size: 16px;
  cursor: pointer; transition: 0.3s; margin-top: 10px;
}
.btn-auth:hover { box-shadow: 0 0 20px var(--glow-color); transform: scale(1.02); }
.switch-text { margin-top: 10px; font-size: 13px; }
.switch-text span { color: var(--glow-color); cursor: pointer; font-weight: bold; text-decoration: underline; }
#error-msg { color: #ff4444; font-size: 12px; margin-top: 10px; min-height: 18px; }
#success-msg { color: #4CAF50; font-size: 12px; margin-top: 10px; min-height: 18px; }
#forgot-email { display: none; margin-top: 10px; }
</style>
</head>
<body>

<div class="bg-glow"></div>

<div class="auth-card">
<h2>HOBA TECH</h2>
<p id="title">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ù…Ø³ØªØ´Ø§Ø±</p>

<div id="login-form">
  <input type="email" id="l-email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
  <div style="height: 10px;"></div>
  <input type="password" id="l-pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
  <button class="btn-auth" id="login-btn">Ø¯Ø®ÙˆÙ„</button>
  <p class="switch-text"><span id="forgot-btn">Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±ØŸ</span></p>
  <div id="forgot-email">
    <input type="email" id="f-email" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†">
    <button class="btn-auth" id="reset-btn" style="margin-top:5px;">Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†</button>
  </div>
  <p class="switch-text">Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <span onclick="toggleMode()">Ø£Ù†Ø´Ø¦ Ø­Ø³Ø§Ø¨Ùƒ Ø§Ù„Ø¢Ù†</span></p>
</div>

<div id="signup-form" style="display: none;">
  <input type="text" id="s-name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">
  <input type="tel" id="s-phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„" style="margin-top: 10px;">
  <select id="s-group" style="margin-top: 10px;">
    <option value="" disabled selected>Ø§Ø®ØªØ± Ø§Ù„ÙØ±Ù‚Ø©</option>
    <option>Ø§Ù„ÙØ±Ù‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰</option>
    <option disabled style="color: gray;">Ø§Ù„ÙØ±Ù‚Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© ğŸ”’</option>
    <option disabled style="color: gray;">Ø§Ù„ÙØ±Ù‚Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø© ğŸ”’</option>
    <option disabled style="color: gray;">Ø§Ù„ÙØ±Ù‚Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø© ğŸ”’</option>
</select>
  <input type="email" id="s-email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" style="margin-top: 10px;">
  <input type="password" id="s-pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±" style="margin-top: 10px;">
  <button class="btn-auth" id="signup-btn" style="margin-top:10px;">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</button>
  <p class="switch-text">Ø¹Ù†Ø¯Ùƒ Ø­Ø³Ø§Ø¨ØŸ <span onclick="toggleMode()">Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ</span></p>
</div>

<div id="error-msg"></div>
<div id="success-msg"></div>
</div>

<script type="module">
// ---------------- Firebase Setup ----------------
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
import { getDatabase, ref, get, child, set } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyAjpqfDdoxYs8rRBw4UKOrvtMoqBDB0Z_s",
  authDomain: "hoba-tech.firebaseapp.com",
  projectId: "hoba-tech",
  storageBucket: "hoba-tech.firebasestorage.app",
  messagingSenderId: "465948708700",
  appId: "1:465948708700:web:dac008d1cb9f8caa50fb99",
  measurementId: "G-EBHF8FEDB2"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const database = getDatabase(app);

// ---------------- Toggle Mode ----------------
window.toggleMode = function() {
    const loginForm = document.getElementById('login-form');
    const signupForm = document.getElementById('signup-form');
    const title = document.getElementById('title');
    if (loginForm.style.display === 'none') {
        loginForm.style.display = 'block';
        signupForm.style.display = 'none';
        title.innerText = "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ù…Ø³ØªØ´Ø§Ø±";
    } else {
        loginForm.style.display = 'none';
        signupForm.style.display = 'block';
        title.innerText = "Ø§Ù†Ø¶Ù… Ù„Ø¹Ø§Ø¦Ù„Ø© Ù‡ÙˆØ¨Ø§ ØªÙŠÙƒ";
    }
};

// ---------------- Signup ----------------
document.getElementById('signup-btn').addEventListener('click', () => {
    const name = document.getElementById('s-name').value;
    const phone = document.getElementById('s-phone').value;
    const group = document.getElementById('s-group').value;
    const email = document.getElementById('s-email').value;
    const password = document.getElementById('s-pass').value;
    const errorMsg = document.getElementById('error-msg');
    const successMsg = document.getElementById('success-msg');

    createUserWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
            const user = userCredential.user;
            // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ù€ Database
            set(ref(database, 'users/' + user.uid), {
                name: name,
                phone: phone,
                group: group,
                email: email
            });
            successMsg.innerText = 'Ù…Ø¨Ø±ÙˆÙƒ ÙŠØ§ Ù…Ø³ØªØ´Ø§Ø± ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„!';
            errorMsg.innerText = '';
            setTimeout(()=>{ window.location.href = "Ø¯Ø§Ø´ 4.html"; }, 1000);
        })
        .catch((error) => { errorMsg.innerText = error.message; successMsg.innerText=''; });
});

// ---------------- Login ----------------
document.getElementById('login-btn').addEventListener('click', () => {
    const email = document.getElementById('l-email').value;
    const password = document.getElementById('l-pass').value;
    const errorMsg = document.getElementById('error-msg');
    const successMsg = document.getElementById('success-msg');

    signInWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
            successMsg.innerText = 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„!';
            errorMsg.innerText = '';
            setTimeout(()=>{ window.location.href = "Ø¯Ø§Ø´ 4.html"; }, 500);
        })
        .catch((error) => { errorMsg.innerText = 'Ø®Ø·Ø£ ÙÙŠ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ'; successMsg.innerText=''; });
});

// ---------------- Forgot Password ----------------
document.getElementById('forgot-btn').addEventListener('click', () => {
    document.getElementById('forgot-email').style.display = 'block';
    document.getElementById('success-msg').innerText='';
    document.getElementById('error-msg').innerText='';
});

document.getElementById('reset-btn').addEventListener('click', () => {
    const fEmail = document.getElementById('f-email').value;
    const errorMsg = document.getElementById('error-msg');
    const successMsg = document.getElementById('success-msg');
    const dbRef = ref(database);

    get(child(dbRef, 'users')).then((snapshot) => {
        let found = false;
        snapshot.forEach((childSnap)=>{
            if(childSnap.val().email === fEmail){
                found = true;
            }
        });
        if(found){
            sendPasswordResetEmail(auth, fEmail)
            .then(()=>{ successMsg.innerText='ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±'; errorMsg.innerText=''; })
            .catch((err)=>{ errorMsg.innerText=err.message; successMsg.innerText=''; });
        } else {
            errorMsg.innerText='Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ù„Ø¯ÙŠÙ†Ø§';
            successMsg.innerText='';
        }
    }).catch((err)=>{ errorMsg.innerText=err.message; successMsg.innerText=''; });
});

// ---------------- Auto-login ----------------
onAuthStateChanged(auth, (user) => {
    if(user){ window.location.href = "Ø¯Ø§Ø´ 4.html"; }
});
</script>

</body>
</html>
